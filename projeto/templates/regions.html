<!DOCTYPE html>
<html>
  <head lang="pt-BR">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link 
      href="https://fonts.googleapis.com/css2?family=Mukta:wght@300;400;500;600;700&display=swap" 
      rel="stylesheet"
    />

    <link href="../static/css/main.css" rel="stylesheet" />
    <link href="../static/css/menu.css" rel="stylesheet" />
    <link href="../static/css/modal.css" rel="stylesheet" />
    <link href="../static/css/search-options.css" rel="stylesheet" />
    <link href="../static/css/regions.css" rel="stylesheet" />
    <link href="../static/css/cards.css" rel="stylesheet" />
    <script src="../static/js/jquery-3.6.0.min.js"></script>
    <script src="../static/js/modals.js"></script>

    <title>Análise de Dados Eleitorais</title>
    <link rel="shortcut icon" href="../static/img/favicon.ico" />
  </head>

  <body>
    <header>
      <!-- Título da Página -->
      <div id="logo">
        <img src="../static/img/icon-logo.svg" alt="Logo - Eleitorado.com"/>
        <h1>Análise de Dados Eleitorais</h1>
      </div>
      
      <nav id="navigation">
        <a id="start" href="/">Início</a>
        <a id="project" href="/project">Sobre o projeto</a>
        <a id="us" href="/about-us">Sobre nós</a>
      </nav>
    </header>

    <main>
      <!--tipo de pesquisa-->
      <div id="search-by">
        <div id="search-by-city">
          <a class="search-by-link" href="/">Pesquisa por cidades</a>
        </div>
        <div id="search-by-region">
          <a class="search-by-link" href="/search-region">Comparação de regiões</a>
        </div>
      </div>
      <!--realizar pesquisas-->
      <div id="search-action">
          <h2>Faça uma pesquisa:</h2>
      </div>
      <!--realizar pesquisas-->  
      <div id="search-all">
        <!-- Menu de busca -->
        <div class="search">      
          <form id="form-search" action="/search-region" method="GET">
            <div class="input-group">
              <!-- Filtro de comparação -->
              <div class="filter">
                <label for="comparison">Tipo de comparação:</label>
                <select name="comparison" id="comparison">
                  <option selected disabled value="default"></option>
                  <option value="jovens">Por quantidade de eleitores jovens</option>
                  <option value="idosos">Por quantidade de eleitores idosos</option>
                  <option value="renda">Por renda</option>
                  <option value="evolucao">Por evolução na quantidade de eleitores</option>
                </select>
              </div>
              <!-- Filtro de ano -->
              <div class="filter">
                <label id='labelYear' for="year">Ano:</label>
                <select name="year" id="year">
                  <option selected disabled value="default"></option>
                  <option value="2024">2024</option>
                  <option value="2022">2022</option>
                  <option value="2020">2020</option>
                  <option value="2018">2018</option>
                </select>
              </div>
            </div>
          </form>
        </div>
        <!-- Botões de limpar campos dos filtros e de enviar dados -->
        <div class="button-group">
          <button onclick="clearFilters()">
            <img src="../static/img/icon-clear.svg" />
          </button>
          <button
            id="search"
            type="submit"
            title="Pesquisar"
            onclick="enableCards()"
          >
            <img src="../static/img/icon-search.svg" />
          </button>
        </div>
      </div>

      <!-- Exibição dos cards com o resultado da busca -->
      <div id="search-result">
        <p>Selecione os filtros e realize uma pesquisa!</p>
      </div>
    </main>

    <!-- Modal de zoom em gráficos-->
    <div class="modal-overlay">
      <div class="modal-container-zoom">
          <div class="modal-header">
            <h2 id="chartTitle">Titulo do Gráfico</h2>
            <img
              id="close"
              src="../static/img/icon-close.png"
              alt="Fechar janela"
              onclick="Modal.toggleZoom()"
            />
          </div>

          <div class="zoom-graphic">
            <!-- Gráfico com zoom -->
            <div id="chart-zoom-container">
              <div class="graphic-zoom">   
                  <p id='canvas'></p>
                  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
                  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>
              </div>
            </div>
            <!-- // Gráfico com zoom -->
          </div>
        </div>
      </div>
    </div>

    <!-- Script do Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>

    <script>
      // usando o jquery para filtrar os anos de acordo com os cargos selecionados
      $("#comparison").change(function(){ // 'change' identifica quando há mudanças no campo
        var searchComparison = $(this).val(); // salva o valor do campo na variável searchRole

        switch (searchComparison) {
          case 'jovens':
            $('#year').val("default").change();
            $('#year, #labelYear').show();
            break;
          case 'idosos':
            $('#year').val("default").change();
            $('#year, #labelYear').show();
            break;
          case 'renda':
            $('#year').val("").change();
            $('#year, #labelYear').hide();
            break;
          case 'evolucao':
            $('#year').val("").change();
            $('#year, #labelYear').hide();
            break;
        }

      });

      // variáveis globais
      function global() {
        var dataKeys = []; // Dados para zoom
        var dataValues = []; // Dados para zoom
        var dataAll = []; // Dados para exportação

        var dataPorcentage = []
      }

      // Função de limpar pesquisa
      function clearFilters() {
        // limpa filtros
        var form = document.getElementById('form-search')
        form.reset()

        // Limpa os cards
        results = document.getElementById("search-result");
        results.innerHTML = '<p>Selecione os filtros e realize uma pesquisa!</p>'
      }

      //ativa os cards
      function enableCards() {
        //capturando os valores dos campos da busca
        var comparisonField = document.querySelector('#comparison')
        var comparison = comparisonField.value

        var yearField = document.querySelector('#year')
        var year = yearField.value

        //define o tipo de gráfico que será exibido
        var typeChart = ""
        if (comparison == "jovens" || comparison == "idosos") {
          typeChart = 'bar';
        } else {
          typeChart = 'line';
        };
      
        // Limpa o que tiver no lugar dis resultados
        results = document.getElementById("search-result");
        results.innerHTML = '<p>Aguarde, a sua busca está sendo feita!</p>'

        // verifica se os campos foram preenchidos corretamente
        if (comparison == "default") {
          alert('Por favor, preencha todos os campos!')
          results = document.getElementById("search-result");
          results.innerHTML = '<p>Selecione os filtros e realize uma pesquisa!</p>'
        } else if ((comparison=='jovens' || comparison == 'idosos') && year=='default') {
          alert('Por favor, preencha todos os campos!')
          results = document.getElementById("search-result");
          results.innerHTML = '<p>Selecione os filtros e realize uma pesquisa!</p>'
        } else {
          //gerando os gráficos com os dados recebidos por json
          $.ajax({
            url: "http://localhost:5000/data-regions?comparison=" + comparison + "&year=" + year,
            dataType: "json",
            success: function (data) {           
              //div para mostrar os cards
              phase = document.querySelector("#search-result p");
              phase.innerHTML = "";
              
              results = document.getElementById('search-result')
              //recebendo o json
              data = JSON.parse(JSON.stringify(data));

              if (Object.keys(data).length != 1) {

                //zerando variáveis globais
                global.dataKeys = [];
                global.dataValues = [];
                global.dataAll = [];
                global.dataPorcentage = []

                var typeChart = ""

                // PESQUISA POR JOVENS OU IDOSOS
                if (comparison == "jovens" || comparison == "idosos") {

                  // Definindo o tipo de gráfico
                  typeChart = 'bar';

                  // Inserindo o HTML do gráfico
                  results.innerHTML = `
                    <div class="result">
                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-0" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Litoral Norte</h2>
                          <a href="https://www.tse.jus.br/eleicoes/estatisticas/repositorio-de-dados-eleitorais-1/repositorio-de-dados-eleitorais" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(0, 'Região do Litoral Norte', 'Quantidade de eleitores', 'bar', 1)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownloadAge(0, 'idade-litoral-norte-${year}')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-1" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Região Bragantina</h2>
                          <a href="https://www.tse.jus.br/eleicoes/estatisticas/repositorio-de-dados-eleitorais-1/repositorio-de-dados-eleitorais" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(1, 'Região Bragantina', 'Quantidade de eleitores', 'bar', 1)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownloadAge(1, 'idade-regiao-bragantina-${year}')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-2" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Serra da Mantiqueira</h2>
                          <a href="https://www.tse.jus.br/eleicoes/estatisticas/repositorio-de-dados-eleitorais-1/repositorio-de-dados-eleitorais" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(2, 'Região da Serra da Mantiqueira', 'Quantidade de eleitores', 'bar', 1)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownloadAge(2, 'idade-serra-mantiqueira-${year}')"
                            />
                          </div>
                        </div>
                      </div>              

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-3" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Vale Histórico</h2>
                          <a href="https://www.tse.jus.br/eleicoes/estatisticas/repositorio-de-dados-eleitorais-1/repositorio-de-dados-eleitorais" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(3, 'Região do Vale Histórico', 'Quantidade de eleitores', 'bar', 1)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownloadAge(3, 'idade-vale-historico-${year}')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-4" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Vale do Paraíba</h2>
                          <a href="https://www.tse.jus.br/eleicoes/estatisticas/repositorio-de-dados-eleitorais-1/repositorio-de-dados-eleitorais" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(4, 'Região do Vale do Paraíba', 'Quantidade de Eleitores', 'bar', 1)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownloadAge(4, 'idade-vale-paraiba-${year}')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-5" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Cobertura da Vanguarda</h2>
                          <a href="https://www.tse.jus.br/eleicoes/estatisticas/repositorio-de-dados-eleitorais-1/repositorio-de-dados-eleitorais" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(5, 'Cobertura da Vanguarda', 'Quantidade de eleitores', 'bar', 1)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownloadAge(5, 'idade-vanguarda-${year}')"
                            />
                          </div>
                        </div>
                      </div>

                    </div>
                  `;

                  //configurando o gráfico
                  var contCanvas = 0;
                  Object.keys(data).forEach(function(card){
                    Chart.defaults.global.defaultFontColor = "#ffff";
                    var ctx = document.getElementById("chart-" + contCanvas).getContext("2d");
                    var myChart = new Chart(ctx, {
                      type: typeChart,
                      data: {
                        labels: data[card]['Cidades'],
                        datasets: [
                          {
                            data: data[card]['Quantia'],
                            backgroundColor: "rgba(154, 219, 249, 0.4)",
                            borderColor: "rgba(154, 219, 249)",
                            borderWidth: 1,
                            datalabels: {
                              align: '',
                              anchor: ''
                            }
                          },
                        ],
                      },
                      options: {
                        plugins: {
                          datalabels: {
                            color: '',
                            font: {},
                            formatter: {}
                          }
                        },
                        legend: {
                          display: false,
                        },
                        scales: {
                          yAxes: [
                            {
                              ticks: {
                                beginAtZero: true,
                              },
                            },
                          ],
                          xAxes: [
                            {
                              display: false,
                            },
                          ],
                        },
                      },
                    })

                    // Salvando os dados recebidos pelo back em variáveis globais
                    global.dataKeys.push(data[card]['Cidades']);
                    global.dataValues.push(data[card]['Quantia']);
                    global.dataPorcentage.push(data[card]['Porcentagem']);
                    global.dataAll.push(data[card]);

                    // Acrescentando 1 no contCanvas
                    contCanvas = contCanvas + 1;
                  });

                // PESQUISA POR RENDA
                } else if (comparison == "renda") { 
                  // Definindo o tipo de gráfico
                  typeChart = 'line';

                  // Inserindo o HTML do gráfico
                  results.innerHTML = `
                    <div class="result">
                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-0" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Litoral Norte</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(0, 'Média salarial do Litoral Norte a partir de 2008', 'Salários mínimos', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(0, 'salario-litoral-norte')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-1" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Região Bragantina</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(1, 'Média salarial da Região Bragantina a partir de 2008', 'Salários mínimos', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(1, 'salario-regiao-bragantina')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-2" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Serra da Mantiqueira</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(2, 'Média salarial da Serra da Mantiqueira a partir de 2008', 'Salários mínimos', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(2, 'salario-serra-mantiqueira')"
                            />
                          </div>
                        </div>
                      </div>              

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-3" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Vale Histórico</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(3, 'Média salarial do Vale Histórico a partir de 2008', 'Salários mínimos', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(3, 'salario-vale-historico')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-4" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Vale do Paraíba</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(4, 'Média salarial do Vale do Paraíba a partir de 2008', 'Salários mínimos', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(4, 'salario-vale-paraiba')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-5" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Cobertura da Vanguarda</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(5, 'Média salarial da Cobertura da Vanguarda a partir de 2008', 'Salários mínimos', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(5, 'salario-vanguarda')"
                            />
                          </div>
                        </div>
                      </div>

                    </div>
                  `;

                  //configurando o gráfico
                  var contCanvas = 0;
                  Object.keys(data).forEach(function(card){
                    Chart.defaults.global.defaultFontColor = "#ffff";
                    var ctx = document.getElementById("chart-" + contCanvas).getContext("2d");
                    var myChart = new Chart(ctx, {
                      type: typeChart,
                      data: {
                        labels: Object.keys(data[card]),
                        datasets: [
                          {
                            data: Object.values(data[card]),
                            backgroundColor: "rgba(154, 219, 249, 0.4)",
                            borderColor: "rgba(154, 219, 249)",
                            borderWidth: 1,
                            datalabels: {
                              align: '',
                              anchor: ''
                            }
                          },
                        ],
                      },
                      options: {
                        plugins: {
                          datalabels: {
                            color: '',
                            font: {},
                            formatter: {}
                          }
                        },
                        legend: {
                          display: false,
                        },
                        scales: {
                          yAxes: [
                            {
                              ticks: {
                                beginAtZero: true,
                              },
                            },
                          ],
                          xAxes: [
                            {
                              display: false,
                            },
                          ],
                        },
                      },
                    })

                    // Salvando os dados recebidos pelo back em variáveis globais
                    global.dataKeys.push(Object.keys(data[card]));
                    global.dataValues.push(Object.values(data[card]));
                    global.dataAll.push(data[card]);

                    // Acrescentando 1 no contCanvas
                    contCanvas = contCanvas + 1;
                  })

                // PESQUISA POR EVOLUÇÃO DO ELEITORADO
                }else {
                  // Definindo o tipo de gráfico
                  typeChart = 'line';

                  // Inserindo o HTML do gráfico
                  results.innerHTML = `
                    <div class="result">
                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-0" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Litoral Norte</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(0, 'Evolução da quantidade de eleitores do Litoral Norte', 'Quantidade de eleitores', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(0, 'evolucao-litoral-norte')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-1" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Região Bragantina</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(1, 'Evolução da quantidade de eleitores da Região Bragantina', 'Quantidade de eleitores', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(1, 'evolucao-regiao-bragantina')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-2" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Serra da Mantiqueira</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(2, 'Evolução da quantidade de eleitores da Serra da Mantiqueira', 'Quantidade de eleitores', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(2, 'evolucao-serra-mantiqueira')"
                            />
                          </div>
                        </div>
                      </div>              

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-3" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Vale Histórico</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(3, 'Evolução da quantidade de eleitores do Vale Histórico', 'Quantidade de eleitores', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(3, 'evolucao-vale-historico')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-4" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Vale do Paraíba</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(4, 'Evolução da quantidade de eleitores do Vale do Paraíba', 'Quantidade de eleitores', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(4, 'evolucao-vale-paraiba')"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="card">
                        <div class="graphic">
                          <div class="graphic-normal">
                            <!-- CANVAS DO GRÁFICO -->
                            <canvas id="chart-5" width="150px" height="140px"></canvas>
                          </div>
                        </div>
                        <div class="graphic-description">
                          <!-- DADOS DO GRÁFICO -->
                          <h2>Cobertura da Vanguarda</h2>
                          <a href="https://cidades.ibge.gov.br/brasil/sp/sao-jose-dos-campos/pesquisa/19/29765?localidade1=355410&localidade2=355030" target="_blank">Dados do IBGE</a>

                          <div class="icon-actions">
                            <!-- Ícone de zoom -->
                            <img
                              id="zoom"
                              src="../static/img/icon-zoom.svg"
                              alt="Aumentar gráfico"
                              onclick="Modal.toggleZoom(5, 'Evolução da quantidade de eleitores da Cobertura da Vanguarda', 'Quantidade de eleitores', 'line', 0)"
                            />

                            <!-- Ícone de download. Ao ser clicado: seleção do formato para download do resultado -->
                            <img
                              id="download"
                              src="../static/img/icon-download.svg"
                              alt="Baixar"
                              onclick="Modal.toggleDownload(5, 'evolucao-vanguarda')"
                            />
                          </div>
                        </div>
                      </div>

                    </div>
                  `;

                  //configurando o gráfico
                  var contCanvas = 0;
                  Object.keys(data).forEach(function(card){
                    Chart.defaults.global.defaultFontColor = "#ffff";
                    var ctx = document.getElementById("chart-" + contCanvas).getContext("2d");
                    var myChart = new Chart(ctx, {
                      type: typeChart,
                      data: {
                        labels: Object.keys(data[card]),
                        datasets: [
                          {
                            data: Object.values(data[card]),
                            backgroundColor: "rgba(154, 219, 249, 0.4)",
                            borderColor: "rgba(154, 219, 249)",
                            borderWidth: 1,
                            datalabels: {
                              align: '',
                              anchor: ''
                            }
                          },
                        ],
                      },
                      options: {
                        plugins: {
                          datalabels: {
                            color: '',
                            font: {},
                            formatter: {}
                          }
                        },
                        legend: {
                          display: false,
                        },
                        scales: {
                          yAxes: [
                            {
                              ticks: {
                                beginAtZero: true,
                              },
                            },
                          ],
                          xAxes: [
                            {
                              display: false,
                            },
                          ],
                        },
                      },
                    })

                    // Salvando os dados recebidos pelo back em variáveis globais
                    global.dataKeys.push(Object.keys(data[card]));
                    global.dataValues.push(Object.values(data[card]));
                    global.dataAll.push(data[card]);

                    // Acrescentando 1 no contCanvas
                    contCanvas = contCanvas + 1;
                  })

                };

                // verificando variáveis globais
                console.log(global.dataKeys)
                console.log(global.dataValues)
                console.log(global.dataAll)
                console.log(global.dataPorcentage)
              
              } else {

                var csvList = ""
                for (var i = 0; i < data.length; i++) {
                  csvList += `<li>${data[i]}</li>`
                }

                phase.innerHTML = ""
                phase.innerHTML = `Os seguintes CSVs precisam estar na pasta "jupyter-notebooks/data": <ul>${csvList}</ul>`               
              }
            }
          });
        }
      }
    </script>
  </body>
</html>